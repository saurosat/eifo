---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by tnguyen.
--- DateTime: 10/11/23 7:55 AM
---
local utils = eifo.utils
ngx.log(ngx.INFO, "URI: ____"..ngx.var.request_uri.."_____")
local route, params, noLayout = eifo.route:getRoute(ngx.var.request_uri)
local content, status = route:render(params, noLayout)
if status < 200 or status >= 400 then
    utils.responseError(status, "Error")
    return
end

ngx.header.content_type = route:getContentType()
ngx.send_headers()
ngx.print(content)
ngx.eof()
route:saveToFile(content, params, noLayout)